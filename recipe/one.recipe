from calibre.web.feeds.recipes import BasicNewsRecipe

class One(BasicNewsRecipe):
    title = 'ONE'
    __author__ = 'lord63'
    description = 'ONE'
    timefmt = '[%Y-%m-%d]'
    no_stylesheets = True
    INDEX = 'http://wufazhuce.com/one'
    keep_only_tags = [dict(id='tab-imagen'), dict(id='tab-articulo'), dict(id='tab-cuestion')]


    def get_title(self, tag):
        a = tag.p.a
        return a.contents[1].string + ' ' + a.contents[2].strip()


    def parse_index(self):
        soup = self.index_to_soup(self.INDEX)
        today = soup.find('div', 'corriente')
        volumes = soup.findAll('div', 'col-sm-4 pasado')
        volumes.insert(0, today)
        articles = []
        for volume in volumes:
            title = self.get_title(volume)
            url = volume.a['href']
            article = {'title': title, 'url': url}
            articles.append(article)
        return [('ONE', articles)]

